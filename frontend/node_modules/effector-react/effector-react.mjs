function e(e,t,n){let r=[d.run({fn:e=>t(e)})];if(n){let t=y({node:r}),o=e.graphite.id,u=n.additionalLinks,a=u[o]||[];return u[o]=a,a.push(t),()=>{let e=a.indexOf(t);-1!==e&&a.splice(e,1),k(t)}}{let t=y({node:r,parent:[e],family:{owners:e}});return()=>{k(t)}}}function t(e,t){return t.displayName=e,t}function n(t,n){g.store(t)||S('expect useStore argument to be a store');let r=w(t,n),o=N(),u=m.useRef({store:t,value:r,pending:0});return b((()=>{let r=e(t,(e=>{let t=u.current;t.pending||(t.value=e,t.pending=1,o(),t.pending=0)}),n),a=w(t,n),s=u.current;return s.store===t&&s.value!==a&&(s.value=a,s.pending=1,o(),s.pending=0),s.store=t,r}),[t,n]),r}function r([t,n],r){let u,a,s,l=j;n?(u=n,a=t,s=[]):(u=t.fn,a=t.store,s=t.keys,l=t.updateFilter||j),g.store(a)||S('useStoreMap expects a store'),Array.isArray(s)||S('useStoreMap expects an array as keys'),'function'!=typeof u&&S('useStoreMap expects a function');let c=m.useRef({}),i=c.current;i.fn=u,i.upd=l,i.init=i.store===a,i.store=a;let f=N(),p=[r,...s],d=m.useMemo((()=>(o(w(a,r),s,c.current),e(a,(e=>o(e,s,c.current,f)),r))),p);return b((()=>()=>d()),p),i.val}function o(e,t,n,r){let o=n.fn(e,t);n.init?void 0!==o&&j(o,n.val)&&n.upd(o,n.val)&&(n.val=o,r&&r()):(n.val=o,n.init=1)}function u(e){return e}function a(e){return n(e)}function s(e,t){return r([e,t])}function l(e,o){return((e,o,u)=>{let a,s,l=[];'object'==typeof o&&null!==o?(o.keys&&(l=o.keys),a=o.fn,o.getKey&&(s=o.getKey)):a=o,g.store(e)||S('expect useList first argument to be a store'),'function'!=typeof a&&S("expect useList's renderItem to be a function"),Array.isArray(l)||S("expect useList's keys to be an array");let c=m.useMemo((()=>{let n=t(`${e.shortName||'Unknown'}.Item`,(t=>{let{index:n,keys:o,keyVal:a,value:s}=t;if(i.current[1])return i.current[0](s,a);let l=r([{store:e,keys:[n,...o],fn:(e,t)=>e[t[0]]}],u);return i.current[0](l,n)}));return m.memo(n)}),[e,u,!!s]),i=m.useRef([a,s]);i.current=[a,s];let f=m.useMemo((()=>l),l);if(s)return n(e,u).map((e=>{let t=i.current[1](e);return m.createElement(c,{keyVal:t,key:t,keys:f,value:e})}));{let t=r([{store:e,keys:[e],fn:e=>e.length}],u);return Array.from({length:t},((e,t)=>m.createElement(c,{index:t,key:t,keys:f})))}})(e,o)}function c(e,n){function r(e){let t=m.useRef(e),r=a(o);b((()=>(s({props:t.current,state:o.getState()}),()=>{l({props:t.current,state:o.getState()})})),[]);let u=n(e,r);return t.current=e,u}let o;g.store(e)?o=e:'object'==typeof e&&null!==e?o=v(e):S('shape should be a store or object with stores');let u='Unknown';o&&o.shortName&&(u=o.shortName);let s=h(),l=h();return r.mounted=s,r.unmounted=l,t(`${u}.View`,r)}function i(e){return c(e,(({children:e},t)=>e(t)))}function f(e,t={}){let n=m.useRef({value:null,count:0});b((()=>(e.open(n.current.value),()=>e.close(n.current.value))),[e]),((e,t)=>{if(e===t)return 1;if('object'==typeof e&&null!==e&&'object'==typeof t&&null!==t){let n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return 0;for(let r=0;r<n.length;r++){let o=n[r];if(e[o]!==t[o])return 0}return 1}return 0})(n.current.value,t)||(n.current.value=t,n.current.count+=1),b((()=>{e.set(n.current.value)}),[n.current.count])}function p(e="gate",n={}){let r;return'object'==typeof e&&null!==e&&('defaultState'in e&&(n=e.defaultState),e.domain&&(r=e.domain),e=e.name),(({name:e="gate",domain:n,defaultState:r,hook:o})=>{function u(e){return o(u,e),null}let a=`${n?`${n.compositeName.fullName}/`:''}${e}`,s=h(`${a}.set`),l=h(`${a}.open`),c=h(`${a}.close`),i=x(Boolean(0),{name:`${a}.status`}).on(l,(()=>Boolean(1))).on(c,(()=>Boolean(0))),f=x(r,{name:`${a}.state`}).on(s,((e,t)=>t)).reset(c);if(n){let{hooks:e}=n;$({target:[e.store,e.store,e.event,e.event,e.event],params:[i,f,l,c,s]})}return u.open=l,u.close=c,u.status=i,u.state=f,u.set=s,t(`Gate:${a}`,u)})({name:e,domain:r,defaultState:n,hook:f})}import m from'react';import{step as d,createNode as y,clearNode as k,is as g,combine as v,createEvent as h,createStore as x,launch as $}from'effector/effector.mjs';let b='undefined'!=typeof window?m.useLayoutEffect:m.useEffect,S=e=>{throw Error(e)};const w=(e,t)=>t?t.getState(e):e.getState(),j=(e,t)=>e!==t,N=()=>m.useReducer((e=>e+1),0)[1];let R=e=>console.error(`${e} is deprecated`),C=(e,n,r)=>(R('createContextComponent'),t(`${e.shortName||'Unknown'}.ContextComponent`,(t=>{let o=m.useContext(n),u=a(e);return r(t,u,o)}))),E=e=>n=>{let r=e;return'function'!=typeof e&&(r=n,n=e),t(`Connect(${r.displayName||r.name||'Unknown'})`,(e=>m.createElement(r,{...e,...a(n)})))},M=(e,t)=>(R('createReactState'),E(t)(e));export{E as connect,c as createComponent,C as createContextComponent,p as createGate,M as createReactState,i as createStoreConsumer,u as useEvent,f as useGate,l as useList,a as useStore,s as useStoreMap};
//# sourceMappingURL=effector-react.mjs.map
